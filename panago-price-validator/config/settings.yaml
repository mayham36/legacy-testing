# Automation Settings
# Update these based on testing and site behavior

# =============================================================================
# ENVIRONMENT CONFIGURATION
# =============================================================================
# Set the active environment: "qa" or "production"
# Command line --env flag overrides this setting
active_environment: "qa"

environments:
  qa:
    base_url: "https://panagostaging.wpengine.com"
    # QA can run slightly faster since it's not customer-facing
    min_delay_ms: 2000
    max_delay_ms: 4000
    max_concurrent: 3

  production:
    base_url: "https://www.panago.com"
    # Production runs SLOW to minimize impact
    min_delay_ms: 5000
    max_delay_ms: 10000
    max_concurrent: 1  # Only 1 browser at a time on production

# =============================================================================
# SAFE MODE (recommended for production)
# =============================================================================
# When enabled, enforces conservative settings regardless of other config
safe_mode: true
safe_mode_settings:
  max_concurrent: 1           # Single browser only
  min_delay_ms: 5000          # 5 second minimum between actions
  max_delay_ms: 10000         # Up to 10 seconds random delay
  category_delay_ms: 8000     # 8 seconds between categories
  request_delay_ms: 3000      # 3 seconds between page loads

# =============================================================================
# TIMEOUTS
# =============================================================================
timeout_ms: 30000
page_load_timeout_ms: 60000

# =============================================================================
# BROWSER SETTINGS
# =============================================================================
headless: true
viewport_width: 1280
viewport_height: 720
locale: "en-CA"

# =============================================================================
# PARALLELISM (overridden by environment and safe_mode)
# =============================================================================
max_concurrent: 3  # Default - environments override this

# =============================================================================
# RETRY LOGIC
# =============================================================================
retry_attempts: 3
base_delay_ms: 1000

# =============================================================================
# RATE LIMITING (overridden by environment and safe_mode)
# =============================================================================
min_delay_ms: 3000
max_delay_ms: 6000
category_delay_ms: 5000
request_delay_ms: 2000

# =============================================================================
# PRICE COMPARISON
# =============================================================================
tolerance_dollars: 0.01  # Maximum acceptable price difference

# DOM Selectors
# VERIFIED from panago.com inspection - January 2026
selectors:
  # Location selection - VERIFIED (React Autosuggest component)
  # Trigger the city picker modal
  location_trigger: '.react-state-link-choose-location, #city_picker'
  # City input field in the modal
  city_input: '.react-autosuggest__input, input[placeholder="City"]'
  # Autocomplete suggestions container
  autocomplete_container: '.react-autosuggest__suggestions-container, #react-autowhatever-1'
  autocomplete_suggestion: '.react-autosuggest__suggestion, [role="option"]'
  # Save city button
  save_city_button: '.location-choice-panel .primary.button, a.primary.button'
  # Close modal button
  close_modal: '.location-choice-panel .panago-icon-exit'

  # Store locator page (/locations) - VERIFIED
  store_search_input: '.store-locations input[name="name"], input[placeholder="Enter Postal Code or Address"]'
  store_search_button: '.store-locations button[type="submit"], .store-locations .button'

  # Product listing - VERIFIED from panago.com/menu
  product_card: 'ul.products > li, .product-group'
  product_name: '.product-title h4, h4.product-title, .product-header h4, h4.product-group-title'
  product_price: '.product-header .price, .prices li span, .price'

  # Category navigation - VERIFIED
  category_tab: 'ul.menu li a[href*="{category}"]'
  category_link: 'a[href*="/menu/{category}"], ul.menu a[href*="{category}"]'

  # Loading states
  loading_spinner: '.loading, .spinner, [class*="loading"]'
  page_content: 'ul.products, .product-group'

  # Modal (React-based)
  modal_container: '.react-modal-primary, [class*="modal"]'
  modal_close: '.modal-close, button[aria-label="Close"]'

# Menu URLs for direct navigation
menu_urls:
  pizzas: '/menu/pizzas'
  deals: '/menu/deals'
  salads: '/menu/salads'
  sides: '/menu/sides'
  dips: '/menu/dips'
  desserts: '/menu/dessert'
  beverages: '/menu/beverages'

# Fallback selectors if primary selectors fail
fallback_selectors:
  product_card:
    - '.product-group'
    - 'li[class*="product"]'
    - '.feature-item'
  product_name:
    - 'h4'
    - '.heading'
    - '[class*="title"]'
  product_price:
    - '.prices span'
    - '[class*="price"]'
    - '.cost'
